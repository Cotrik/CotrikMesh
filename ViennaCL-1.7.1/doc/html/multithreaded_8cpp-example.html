<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ViennaCL - The Vienna Computing Library: multithreaded.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ViennaCL - The Vienna Computing Library
   &#160;<span id="projectnumber">1.7.1</span>
   </div>
   <div id="projectbrief">Free open-source GPU-accelerated linear algebra and solver library.</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('multithreaded_8cpp-example.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">multithreaded.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>This tutorial shows how to use ViennaCL with multiple threads, one thread per GPU. The use of one thread per context (host, CUDA, OpenCL) is supported. However, using more than one thread per context is not fully covered by the OpenCL standard. It is, however, perfectly fine to use multiple OpenCL contexts simultaneously, each using one thread.</p>
<p>We start with including the necessary headers: </p>
<div class="fragment"><div class="line"><span class="preprocessor">#ifndef VIENNACL_WITH_OPENCL</span></div>
<div class="line"><span class="preprocessor">  #define VIENNACL_WITH_OPENCL</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// include necessary system headers</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">//include basic scalar and vector types of ViennaCL</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="scalar_8hpp.html">viennacl/scalar.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="vector_8hpp.html">viennacl/vector.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="matrix_8hpp.html">viennacl/matrix.hpp</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="device_8hpp.html">viennacl/ocl/device.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="platform_8hpp.html">viennacl/ocl/platform.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="backend_8hpp.html">viennacl/ocl/backend.hpp</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">//include the generic inner product functions of ViennaCL</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="norm__2_8hpp.html">viennacl/linalg/norm_2.hpp</a>&quot;</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;boost/thread.hpp&gt;</span></div>
</div><!-- fragment --><p> Each thread runs a separate task, for which we provide the following functor. For each thread, vector operations and a vector norm gets computed. </p>
<div class="fragment"><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> NumericT&gt;</div>
<div class="line"><span class="keyword">class </span>worker</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  worker(std::size_t tid) : thread_id_(tid) {}</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">void</span> operator()()</div>
<div class="line">  {</div>
<div class="line">    std::size_t N = 6;</div>
<div class="line"></div>
<div class="line">    <a name="_a0"></a><a class="code" href="classviennacl_1_1context.html">viennacl::context</a> ctx(<a name="a1"></a><a class="code" href="namespaceviennacl_1_1ocl.html#a82c1aba632a7ee0991eee480d5340966">viennacl::ocl::get_context</a>(static_cast&lt;long&gt;(thread_id_)));</div>
<div class="line">    <a name="_a2"></a><a class="code" href="classviennacl_1_1vector.html">viennacl::vector&lt;NumericT&gt;</a> u = <a name="_a3"></a><a class="code" href="structviennacl_1_1scalar__vector.html">viennacl::scalar_vector&lt;NumericT&gt;</a>(N, <a name="a4"></a><a class="code" href="tests_2src_2bisect_8cpp.html#a52b5d30a2d7b064678644a3bf49b7f6c">NumericT</a>(1) * <a class="code" href="tests_2src_2bisect_8cpp.html#a52b5d30a2d7b064678644a3bf49b7f6c">NumericT</a>(thread_id_ + 1), ctx);</div>
<div class="line">    <a class="code" href="classviennacl_1_1vector.html">viennacl::vector&lt;NumericT&gt;</a> v = <a class="code" href="structviennacl_1_1scalar__vector.html">viennacl::scalar_vector&lt;NumericT&gt;</a>(N, <a class="code" href="tests_2src_2bisect_8cpp.html#a52b5d30a2d7b064678644a3bf49b7f6c">NumericT</a>(2) * <a class="code" href="tests_2src_2bisect_8cpp.html#a52b5d30a2d7b064678644a3bf49b7f6c">NumericT</a>(thread_id_ + 1), ctx);</div>
<div class="line">    <a name="_a5"></a><a class="code" href="classviennacl_1_1matrix.html">viennacl::matrix&lt;NumericT&gt;</a> A = <a name="a6"></a><a class="code" href="namespaceviennacl_1_1linalg.html#a80b166d4b1b136b020820db3d7572b0d">viennacl::linalg::outer_prod</a>(u, v);</div>
<div class="line">    <a class="code" href="classviennacl_1_1vector.html">viennacl::vector&lt;NumericT&gt;</a> x(u);</div>
<div class="line"></div>
<div class="line">    u += v;</div>
<div class="line">    <a class="code" href="tests_2src_2bisect_8cpp.html#a52b5d30a2d7b064678644a3bf49b7f6c">NumericT</a> result = <a name="a7"></a><a class="code" href="namespaceviennacl_1_1linalg.html#ae46f15d01c01f92a153b3f555a15096b">viennacl::linalg::norm_2</a>(u);</div>
<div class="line"></div>
<div class="line">    std::stringstream ss;</div>
<div class="line">    ss &lt;&lt; <span class="stringliteral">&quot;Result of thread &quot;</span> &lt;&lt; thread_id_ &lt;&lt; <span class="stringliteral">&quot; on device &quot;</span> &lt;&lt; <a class="code" href="namespaceviennacl_1_1ocl.html#a82c1aba632a7ee0991eee480d5340966">viennacl::ocl::get_context</a>(static_cast&lt;long&gt;(thread_id_)).<a name="a8"></a><a class="code" href="classviennacl_1_1ocl_1_1context.html#a122abd131e682733ff44bdf480365ba2">devices</a>()[0].name() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; result &lt;&lt; std::endl;</div>
<div class="line">    ss &lt;&lt; <span class="stringliteral">&quot;  A: &quot;</span> &lt;&lt; A &lt;&lt; std::endl;</div>
<div class="line">    ss &lt;&lt; <span class="stringliteral">&quot;  x: &quot;</span> &lt;&lt; x &lt;&lt; std::endl;</div>
<div class="line">    message_ = ss.str();</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  std::string message()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> message_; }</div>
<div class="line"></div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  std::string message_;</div>
<div class="line">  std::size_t thread_id_;</div>
<div class="line">};</div>
</div><!-- fragment --><p> In the main routine we create two OpenCL contexts and then use one thread per context to run the operations in the functor defined above. </p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a name="a9"></a><a class="code" href="tests_2src_2bisect_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Change this type definition to double if your gpu supports that</span></div>
<div class="line">  <span class="keyword">typedef</span> <span class="keywordtype">float</span>       <a name="a10"></a><a class="code" href="fft__1d_8cpp.html#ad5c19ca4f47d3f8ec21232a5af2624e5">ScalarType</a>;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a name="a11"></a><a class="code" href="namespaceviennacl_1_1ocl.html#ae1e931f6efd155240b33ca440dfcfef5">viennacl::ocl::get_platforms</a>().<a name="a12"></a><a class="code" href="namespaceviennacl_1_1traits.html#aa2344ea20469f55fbc15a8e9526494d0">size</a>() == 0)</div>
<div class="line">  {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: No platform found!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">  }</div>
</div><!-- fragment --><p> Part 1: Setup first device for first context, second device for second context: </p>
<div class="fragment"><div class="line"><a name="_a13"></a><a class="code" href="classviennacl_1_1ocl_1_1platform.html">viennacl::ocl::platform</a> pf = <a class="code" href="namespaceviennacl_1_1ocl.html#ae1e931f6efd155240b33ca440dfcfef5">viennacl::ocl::get_platforms</a>()[0];</div>
<div class="line">std::vector&lt;viennacl::ocl::device&gt; <span class="keyword">const</span> &amp; devices = pf.<a name="a14"></a><a class="code" href="classviennacl_1_1ocl_1_1platform.html#afaa563522ebe9ce7b80ef02c40e7fe31">devices</a>();</div>
<div class="line"></div>
<div class="line"><span class="comment">// Set first device to first context:</span></div>
<div class="line"><a name="a15"></a><a class="code" href="namespaceviennacl_1_1ocl.html#add1725d48cfd159ce187e287369d1cdb">viennacl::ocl::setup_context</a>(0, devices[0]);</div>
<div class="line"></div>
<div class="line"><span class="comment">// Set second device for second context (use the same device for the second context if only one device available):</span></div>
<div class="line"><span class="keywordflow">if</span> (devices.size() &gt; 1)</div>
<div class="line">  <a class="code" href="namespaceviennacl_1_1ocl.html#add1725d48cfd159ce187e287369d1cdb">viennacl::ocl::setup_context</a>(1, devices[1]);</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">  <a class="code" href="namespaceviennacl_1_1ocl.html#add1725d48cfd159ce187e287369d1cdb">viennacl::ocl::setup_context</a>(1, devices[0]);</div>
</div><!-- fragment --><p> Part 2: Now let two threads operate on two GPUs in parallel. </p>
<div class="fragment"><div class="line">worker&lt;ScalarType&gt; work_functor0(0);</div>
<div class="line">worker&lt;ScalarType&gt; work_functor1(1);</div>
<div class="line">boost::thread worker_thread_0(boost::ref(work_functor0));</div>
<div class="line">boost::thread worker_thread_1(boost::ref(work_functor1));</div>
<div class="line"></div>
<div class="line">worker_thread_0.join();</div>
<div class="line">worker_thread_1.join();</div>
<div class="line"></div>
<div class="line">std::cout &lt;&lt; work_functor0.message() &lt;&lt; std::endl;</div>
<div class="line">std::cout &lt;&lt; work_functor1.message() &lt;&lt; std::endl;</div>
</div><!-- fragment --><p> We're done - print a success message. </p>
<div class="fragment"><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;!!!! TUTORIAL COMPLETED SUCCESSFULLY !!!!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
</div><!-- fragment --> <h2>Full Example Code</h2>
<div class="fragment"><div class="line"><span class="comment">/* =========================================================================</span></div>
<div class="line"><span class="comment">   Copyright (c) 2010-2016, Institute for Microelectronics,</span></div>
<div class="line"><span class="comment">                            Institute for Analysis and Scientific Computing,</span></div>
<div class="line"><span class="comment">                            TU Wien.</span></div>
<div class="line"><span class="comment">   Portions of this software are copyright by UChicago Argonne, LLC.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">                            -----------------</span></div>
<div class="line"><span class="comment">                  ViennaCL - The Vienna Computing Library</span></div>
<div class="line"><span class="comment">                            -----------------</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">   Project Head:    Karl Rupp                   rupp@iue.tuwien.ac.at</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">   (A list of authors and contributors can be found in the PDF manual)</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">   License:         MIT (X11), see file LICENSE in the base directory</span></div>
<div class="line"><span class="comment">============================================================================= */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef VIENNACL_WITH_OPENCL</span></div>
<div class="line"><span class="preprocessor">  #define VIENNACL_WITH_OPENCL</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// include necessary system headers</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">//include basic scalar and vector types of ViennaCL</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="scalar_8hpp.html">viennacl/scalar.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="vector_8hpp.html">viennacl/vector.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="matrix_8hpp.html">viennacl/matrix.hpp</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="device_8hpp.html">viennacl/ocl/device.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="platform_8hpp.html">viennacl/ocl/platform.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="backend_8hpp.html">viennacl/ocl/backend.hpp</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">//include the generic inner product functions of ViennaCL</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="norm__2_8hpp.html">viennacl/linalg/norm_2.hpp</a>&quot;</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;boost/thread.hpp&gt;</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> NumericT&gt;</div>
<div class="line"><span class="keyword">class </span>worker</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  worker(std::size_t tid) : thread_id_(tid) {}</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">void</span> operator()()</div>
<div class="line">  {</div>
<div class="line">    std::size_t N = 6;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classviennacl_1_1context.html">viennacl::context</a> ctx(<a class="code" href="namespaceviennacl_1_1ocl.html#a82c1aba632a7ee0991eee480d5340966">viennacl::ocl::get_context</a>(static_cast&lt;long&gt;(thread_id_)));</div>
<div class="line">    <a class="code" href="classviennacl_1_1vector.html">viennacl::vector&lt;NumericT&gt;</a> u = <a class="code" href="structviennacl_1_1scalar__vector.html">viennacl::scalar_vector&lt;NumericT&gt;</a>(N, <a class="code" href="tests_2src_2bisect_8cpp.html#a52b5d30a2d7b064678644a3bf49b7f6c">NumericT</a>(1) * <a class="code" href="tests_2src_2bisect_8cpp.html#a52b5d30a2d7b064678644a3bf49b7f6c">NumericT</a>(thread_id_ + 1), ctx);</div>
<div class="line">    <a class="code" href="classviennacl_1_1vector.html">viennacl::vector&lt;NumericT&gt;</a> v = <a class="code" href="structviennacl_1_1scalar__vector.html">viennacl::scalar_vector&lt;NumericT&gt;</a>(N, <a class="code" href="tests_2src_2bisect_8cpp.html#a52b5d30a2d7b064678644a3bf49b7f6c">NumericT</a>(2) * <a class="code" href="tests_2src_2bisect_8cpp.html#a52b5d30a2d7b064678644a3bf49b7f6c">NumericT</a>(thread_id_ + 1), ctx);</div>
<div class="line">    <a class="code" href="classviennacl_1_1matrix.html">viennacl::matrix&lt;NumericT&gt;</a> A = <a class="code" href="namespaceviennacl_1_1linalg.html#a80b166d4b1b136b020820db3d7572b0d">viennacl::linalg::outer_prod</a>(u, v);</div>
<div class="line">    <a class="code" href="classviennacl_1_1vector.html">viennacl::vector&lt;NumericT&gt;</a> x(u);</div>
<div class="line"></div>
<div class="line">    u += v;</div>
<div class="line">    <a class="code" href="tests_2src_2bisect_8cpp.html#a52b5d30a2d7b064678644a3bf49b7f6c">NumericT</a> result = <a class="code" href="namespaceviennacl_1_1linalg.html#ae46f15d01c01f92a153b3f555a15096b">viennacl::linalg::norm_2</a>(u);</div>
<div class="line"></div>
<div class="line">    std::stringstream ss;</div>
<div class="line">    ss &lt;&lt; <span class="stringliteral">&quot;Result of thread &quot;</span> &lt;&lt; thread_id_ &lt;&lt; <span class="stringliteral">&quot; on device &quot;</span> &lt;&lt; <a class="code" href="namespaceviennacl_1_1ocl.html#a82c1aba632a7ee0991eee480d5340966">viennacl::ocl::get_context</a>(static_cast&lt;long&gt;(thread_id_)).<a class="code" href="classviennacl_1_1ocl_1_1context.html#a122abd131e682733ff44bdf480365ba2">devices</a>()[0].name() &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; result &lt;&lt; std::endl;</div>
<div class="line">    ss &lt;&lt; <span class="stringliteral">&quot;  A: &quot;</span> &lt;&lt; A &lt;&lt; std::endl;</div>
<div class="line">    ss &lt;&lt; <span class="stringliteral">&quot;  x: &quot;</span> &lt;&lt; x &lt;&lt; std::endl;</div>
<div class="line">    message_ = ss.str();</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  std::string message()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> message_; }</div>
<div class="line"></div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  std::string message_;</div>
<div class="line">  std::size_t thread_id_;</div>
<div class="line">};</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="tests_2src_2bisect_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Change this type definition to double if your gpu supports that</span></div>
<div class="line">  <span class="keyword">typedef</span> <span class="keywordtype">float</span>       <a class="code" href="fft__1d_8cpp.html#ad5c19ca4f47d3f8ec21232a5af2624e5">ScalarType</a>;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="namespaceviennacl_1_1ocl.html#ae1e931f6efd155240b33ca440dfcfef5">viennacl::ocl::get_platforms</a>().<a class="code" href="namespaceviennacl_1_1traits.html#aa2344ea20469f55fbc15a8e9526494d0">size</a>() == 0)</div>
<div class="line">  {</div>
<div class="line">    std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: No platform found!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <a class="code" href="classviennacl_1_1ocl_1_1platform.html">viennacl::ocl::platform</a> pf = <a class="code" href="namespaceviennacl_1_1ocl.html#ae1e931f6efd155240b33ca440dfcfef5">viennacl::ocl::get_platforms</a>()[0];</div>
<div class="line">  std::vector&lt;viennacl::ocl::device&gt; <span class="keyword">const</span> &amp; devices = pf.<a class="code" href="classviennacl_1_1ocl_1_1platform.html#afaa563522ebe9ce7b80ef02c40e7fe31">devices</a>();</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Set first device to first context:</span></div>
<div class="line">  <a class="code" href="namespaceviennacl_1_1ocl.html#add1725d48cfd159ce187e287369d1cdb">viennacl::ocl::setup_context</a>(0, devices[0]);</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Set second device for second context (use the same device for the second context if only one device available):</span></div>
<div class="line">  <span class="keywordflow">if</span> (devices.size() &gt; 1)</div>
<div class="line">    <a class="code" href="namespaceviennacl_1_1ocl.html#add1725d48cfd159ce187e287369d1cdb">viennacl::ocl::setup_context</a>(1, devices[1]);</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">    <a class="code" href="namespaceviennacl_1_1ocl.html#add1725d48cfd159ce187e287369d1cdb">viennacl::ocl::setup_context</a>(1, devices[0]);</div>
<div class="line"></div>
<div class="line">  worker&lt;ScalarType&gt; work_functor0(0);</div>
<div class="line">  worker&lt;ScalarType&gt; work_functor1(1);</div>
<div class="line">  boost::thread worker_thread_0(boost::ref(work_functor0));</div>
<div class="line">  boost::thread worker_thread_1(boost::ref(work_functor1));</div>
<div class="line"></div>
<div class="line">  worker_thread_0.join();</div>
<div class="line">  worker_thread_1.join();</div>
<div class="line"></div>
<div class="line">  std::cout &lt;&lt; work_functor0.message() &lt;&lt; std::endl;</div>
<div class="line">  std::cout &lt;&lt; work_functor1.message() &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;!!!! TUTORIAL COMPLETED SUCCESSFULLY !!!!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div>
<div class="line">}</div>
<div class="line"></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Jan 20 2016 22:32:38 for ViennaCL - The Vienna Computing Library by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
